<html>

<script type="text/javascript" src = "https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script type="text/javascript" src = "https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<div class="list" ng-controller="NewPosterController">

  <a class="button icon-left super-chevron-left button-clear button-dark" onclick="window.location.href='settings.html'">Cancel</a>

  <i class = "icon super-ios7-folder-outline" style="font-size: 50px; margin-left: 240px"></i>

  <label class="item item-input item-floating-label">
    <span class="input-label">Study Name</span>
    <form name="formStudyName">
    <input type="text" name="studyName" placeholder="Study Name">
    </form>
  </label>

  <label class="item item-input item-floating-label">
    <span class="input-label">Location</span>
    <form name="formLocation">
    <input type="text" name="location" placeholder="Location">
    </form>
  </label>

  <label class="item item-input item-floating-label">
    <span class="input-label">Duration</span>
    <form name="formDuration">
    <input type="text" name="duration" placeholder="Duration">
    </form>
  </label>

  <label class="item item-input item-floating-label">
    <span class="input-label">Compensation</span>
    <form name="formCompensation">
    <input type="text" name="compensation" placeholder="Compensation">
    </form>
  </label>

  <label class="item item-input item-floating-label">
    <span class="input-label">StartTime</span>
    <form name="formStartTime">
    <input type="text" name="startTime" placeholder="startTime">
    </form>
  </label>

  <label class="item item-input item-floating-label">
    <span class="input-label">EndTime</span>
    <form name="formEndTime">
    <input type="text" name="endTime" placeholder="endTime">
    </form>
  </label>

  <label class="item item-input item-floating-label">
    <span class="input-label">Email</span>
    <form name="formEmail">
    <input type="text" name="email" placeholder="Email">
    </form>
  </label>


  <div>
    <button class="button button-block button-positive" onclick="addData( )">

      Confirm
    </button>
  </div>


</div>

  <script type="text/javascript">

function sleep(milliseconds) {
  var start = new Date().getTime();
  for (var i = 0; i < 1e7; i++) {
    if ((new Date().getTime() - start) > milliseconds){
      break;
    }
  }
}

  function addData( ){
    Parse.initialize("susDpNWLgi3QqeprNxBKeQ7uIJK0srYlde52neVb", "OMWpK5Oa17fiNcDyTkqvbKz2HHL6szH4jPYXlhz0");
     //var TestObject = Parse.Object.extend("TestObject");
     var TestObject = Parse.Object.extend("event");
     var testObject = new TestObject();

     //Get value from form
     var studyName = document.forms["formStudyName"]["studyName"].value;
     var location = document.forms["formLocation"]["location"].value;
     var duration = document.forms["formDuration"]["duration"].value;
     var compensation = document.forms["formCompensation"]["compensation"].value;
     var startTime = document.forms["formStartTime"]["startTime"].value;
     var endTime = document.forms["formEndTime"]["endTime"].value;
     var email = document.forms["formEmail"]["email"].value;


  var options = {
  quality: 50,
  allowEdit: true,
  targetWidth: 300,
  targetHeight: 300,
  encodingType: "jpeg",
  destinationType: "dataURL",
};
// make corner case luke
supersonic.media.camera.getFromPhotoLibrary(options).then( function(result){
  var file;
  var base64 = result;
  file = new Parse.File("upload.jpeg", { base64: base64 });
  testObject.save({posterIcon: file}).then(function(object) {
  });
  sleep(1000);
  alert("update successful");


  window.location.reload();
});

     //Add data into parse
     testObject.save({study: studyName}).then(function(object) {
     });
     testObject.save({location: location}).then(function(object) {
     });
     testObject.save({duration: duration}).then(function(object) {
     });
     testObject.save({compensation: compensation}).then(function(object) {
     });
     testObject.save({startdate_str: startTime}).then(function(object) {
     });
     testObject.save({enddate_str: endTime}).then(function(object) {
     });
     testObject.save({email: email}).then(function(object) {
     });
     testObject.save({likeNum: 0}).then(function(object) {
     });
     testObject.save({dislikeNum: 0}).then(function(object) {
     });

     alert("checkpoint");
}
</script>

</html>
